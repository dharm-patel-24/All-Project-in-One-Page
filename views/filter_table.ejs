<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Filter & Sort Table</title>
    <style>
        th,
        td {
            padding: 5px;
        }

        .up {
            margin-left: 120px;
            opacity: 0.5;
        }

        .down {
            margin-left: 120px;
            opacity: 0.5;
        }

        .main {
            display: flex;
            align-items: center;
        }

        .main2 {
            display: flex;
            align-items: center;
        }

        a {
            color: black;
            text-decoration: none;
        }

        .arr {
            margin-left: -115px;
        }
    </style>
</head>

<body>
    <h1 style="text-align: center;">Dharm Patel</h1>

    <div class="btns" style="display: flex; width: 12%; margin: auto; justify-content: space-around;">
        <a href='/filter?page=1&orderBy=<%= orderBy %>'><button <%=currentPage==1 ? 'disabled' : '' %>><<</button></a>

        <a href='/filter?page=<%=Math.max(1, Number(currentPage)-1)%>&orderBy=<%= orderBy %>'"><button <%= currentPage ==1 ? 'disabled' : '' %>><</button></a>

        <button class=" currentPage">
            <%= currentPage %></button>

                <a href='/filter?page=<%=Math.min(totalPages, Number(currentPage)+1) %>&orderBy=<%= orderBy %>'><button
                        <%=currentPage==totalPages ? 'disabled' : '' %>>></button></a>

                <a href='/filter?page=<%=totalPages%>&orderBy=<%= orderBy %>'><button <%=currentPage==totalPages ? 'disabled'
                        : '' %>>>></button></a>

    </div>
    <br><br>
    <div style="text-align: center;">
        <select id="mnt" onchange="monthChange()">
            <% if(month==12) { %>
                <option value="12" selected>Present in December 2023</option>
                <option value="1">Present in January 2024</option>
                <option value="2">Present in February 2024</option>
                <% } %>

                    <% if(month==1) { %>
                        <option value="12">Present in December 2023</option>
                        <option value="1" selected>Present in January 2024</option>
                        <option value="2">Present in February 2024</option>
                        <% } %>

                            <% if(month==2) { %>
                                <option value="12" selected>Present in December 2023</option>
                                <option value="1">Present in January 2024</option>
                                <option value="2" selected>Present in February 2024</option>
                                <% } %>
        </select>
        <br><br>
        <table border="1" style="text-align: center; margin: 0 auto; border-collapse: collapse;">
            <tr>
                <th>
                    <div class="main">

                        <span>Student Id</span>
                        <div class="arr">
                            <a href='/filter?page=1&orderBy=std_id&order=asc' <% if(order!='desc' && orderBy=='std_id' ) { %> style="opacity:1" <% } %>
                                    class="up">&uarr;</a> <br>
                            <a href='/filter?page=1&orderBy=std_id&order=desc' <% if(order=='desc' && orderBy=='std_id' ) { %> style="opacity:1" <% } %>
                                    class="down">&darr;</a>
                        </div>
                    </div>
                </th>
                <th>
                    <div class="main">
                        <span>First Name</span>
                        <div class="arr">
                            <a href='/filter?page=1&orderBy=first_name&order=asc' <% if(order!='desc' && orderBy=='first_name'
                                ) { %> style="opacity:1" <% } %> class="up">&uarr;</a> <br>
                            <a href='/filter?page=1&orderBy=first_name&order=desc' <% if(order=='desc' &&
                                orderBy=='first_name' ) { %> style="opacity:1" <% } %> class="down">&darr;</a>
                        </div>
                    </div>
                </th>
                <th>
                    <div class="main">
                        <span>Present Days</span>
                        <div class="arr">
                            <a href='/filter?page=1&orderBy=Present_In_Dec&order=asc' <% if(order!='desc' &&
                                orderBy=='Present_In_Dec' ) { %> style="opacity:1" <% } %> class="up">&uarr;</a> <br>
                            <a href='/filter?page=1&orderBy=Present_In_Dec&order=desc' <% if(order=='desc' &&
                                orderBy=='Present_In_Dec' ) { %> style="opacity:1" <% } %> class="down">&darr;</a>
                        </div>
                    </div>
                </th>
                <th>
                    <div class="main">
                        <span>Percentage of Att.</span>
                        <div class="arr">
                            <a href='/filter?page=1&orderBy=Percentage&order=asc' <% if(order!='desc' && orderBy=='Percentage'
                                ) { %> style="opacity:1" <% } %> class="up">&uarr;</a> <br>
                            <a href='/filter?page=1&orderBy=Percentage&order=desc' <% if(order=='desc' &&
                                orderBy=='Percentage' ) { %> style="opacity:1" <% } %> class="down">&darr;</a>
                        </div>
                    </div>
                </th>
            </tr>
            <% data.forEach(function(item) { %>
                <tr>
                    <td>
                        <%= item.std_id %>
                    </td>
                    <td>
                        <%= item.first_name %>
                    </td>
                    <td>
                        <%= item.Present_In_Dec %>
                    </td>
                    <td>
                        <%= item.Percentage %> %
                    </td>
                </tr>
                <% }); %>
        </table>

        <script>
            function monthChange() {
                const month = document.getElementById('mnt').value;
                window.location.href = `/filter?page=1&month=${month}&orderBy=<%=orderBy%>&order=<%=order%>`;
            }

            // function change(colId) {
            //     var order;
            //     if (req.query.order == 'desc') {
            //         order = 'asc';
            //     } else {
            //         order = 'desc';
            //     }
            //     window.location.href = `/?page=1&orderBy=${colId}&order=${order}`;
            // }
        </script>
</body>

</html>